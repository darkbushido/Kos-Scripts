function launch {
  local dir to lazcalc["LAZ"](p["PAlt"], 0).
  if not p["Body"]:obt:inclination = 0 {
    print "waiting for launch window.".
    local lan_t to lazcalc["window"](p["Body"]).
    warpto(lan_t).
    wait until time:seconds >= lan_t.
    set dir to lazcalc["LAZ"](p["PAlt"], p["Body"]:obt:inclination).
  }
  stage. wait 10.
  lock pct_alt to (alt:radar / p["PAlt"]).
  lock target_pitch to 90 - (90* pct_alt^p["PitchExp"]).
  lock steering to heading(dir, target_pitch).
  if not ev:haskey("AutoStage")
    ev:add("AutoStage", ship_utils["auto_stage"]).
  next().
}
